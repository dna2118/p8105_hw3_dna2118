---
title: "p8105_hw3_dna2118"
author: "Dionna Attinson"
date: "10/10/2019"
output: html_document
---
## Problem 1

#### First, we will load the instacart data

```{r setup, include=FALSE}
library(tidyverse)
library(viridis)
library(leaflet)
knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(theme_minimal() + theme(legend.position = "bottom"))
```

```{r}
library(p8105.datasets)
data("instacart")
```
#### Next, we will group the data and count the number of aisles. We will then arrange the dataset to see which aisles have the most items ordered from them.
```{r} 
instacart %>% 
  group_by(aisle) %>% 
  count(aisle) %>% 
  arrange(desc(n))
```
#### We have 134 isles in the dataset. The aisles that are the most items ordered from are the fresh vegetables and fresh fruits, respectively.

```{r}
instacart %>% 
  count(aisle) %>%
  filter (
   n > 10000
  ) %>%
 ggplot(aes(y= n, x=reorder(aisle, n))) +
 geom_bar (stat = "identity") + coord_flip() +
 labs(
  title = "Number of Items Ordered by Aisle",
  x = "Number of Items Ordered",
  y = "Aisle") 
```
```{r}
```
#### Now, we will make a table showing the three most popular items in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”. We also included the number of times each item was ordered. We will then make a (2 x7) table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week.
```{r}
instacart %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>%
  group_by(aisle, product_name) %>% 
  summarize(n=n()) %>%
  filter(min_rank(desc(n)) <4) %>% 
  knitr::kable(col.names = c("Aisle",
                             "Product Name", 
                             "Number of Orders"))
```

```{r} 
instacart %>% 
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>%
  group_by(product_name, order_dow) %>% 
  summarize(mean = mean(order_hour_of_day)) %>% 
  pivot_wider(
   names_from = "order_dow", 
   values_from = "mean") %>% 
   knitr::kable(col.names = c("Product Names",
                             "Sunday",
                             "Monday",
                             "Tuesday", 
                             "Wednesday",
                             "Thursday",
                             "Friday",
                             "Saturday"))
```


